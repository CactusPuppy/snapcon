.panel.panel-default.event-panel{ onClick: 'eventClicked(event, this);', 'data-url': "#{url_for(conference_program_proposal_path(@conference.short_title, event.id))}", tabindex: 0, role: 'link' }
  - header_color = event.event_type&.color || '#f5f5f5'
  .trapezoid{ style: 'color: white; top: 12px; z-index: 100;' }
  .panel-heading{ style: "background-color: #{header_color}; color: #{ contrast_color(header_color) }; border-radius: 4px" }
    %p
      = canceled_replacement_event_label(event, event_schedule)
      = replacement_event_notice(event_schedule)

    %div{ style: 'display: flex; flex-direction: row;' }
      - if current_user
        %spna{ style: 'padding: 8px;' }
          = link_to('#', onClick: 'starClicked();',
                    'aria-label': "#{event.favourite_users.exists?(current_user.id) ? 'un' : ''}favorite event #{event.title}") do
            %i.fa.fa-2x{ style: "color: #{contrast_color(header_color)}", |
                class: event.favourite_users.exists?(current_user.id) ? 'fa-star' : 'fa-star-o', |
                "aria-hidden" => "true", |
                "data-url" => toggle_favorite_conference_program_proposal_path(@conference.short_title, event.id), |
                "data-user" => current_user.id }

      %h3{ style: 'margin: 3px; flex: 1' }
        = event.title
        %br
        -# Need to override bootstrap's coloring of h* > small items.
        %small{ style: "color: #{contrast_color(header_color)}" }
          = event.subtitle

      %span
        - if !defined?(is_brief) || is_brief == false
          - event.speakers_ordered.each do |speaker|
            = image_tag speaker.profile_picture, class: 'img-circle', alt: speaker.name

  .trapezoid{ style: "color: #{header_color}; border-top-color: #{header_color}; top: 12px;" }

  .panel-body
    %h4
      - if(event.speakers.any?)
        = event.speaker_names
    %span.h5
      = join_event_link(event, current_user)
    %p
      = markdown(truncate(event.abstract, length: 400))
      -# TODO: More informative text or aria-label.
      = link_to 'more', conference_program_proposal_path(@conference.short_title, event.id) if event.abstract.length > 400
    - if !defined?(is_brief) || is_brief == false
      - if event_schedule.present?
        = inyourtz(event_schedule.start_time) do
          %span.track
            %span.fa.fa-clock-o
            %span.label{ style: 'background-color: grey' }
              = event_schedule.start_time.strftime('%l:%M %P')
              \-
              = event_schedule.end_time.strftime('%l:%M %P')
        %span.track
          %span.fa.fa-map-marker
          %span.label{ style: 'background-color: grey' }
            = event_schedule.room.name
      - if event.track
        %span.track
          %span.fa.fa-road
          %span.label{ style: "background-color: #{event.track.color}; color: #{ contrast_color(event.track.color) }" }
            = event.track.name
